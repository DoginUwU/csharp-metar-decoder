configuration: Release

before_build:
  - nuget restore
  - nuget install NUnit.Runners -Version 3.8.0
  - nuget install OpenCover -Version 4.6.519
  - nuget install coveralls.net -Version 0.412

build:
  project: csharp-metar-decoder.sln
  verbosity: minimal

environment:
  COVERALLS_SERVICE_NAME: appveyor
  COVERALLS_REPO_TOKEN:
    secure: CAjCS0NsYDheBeTgzVRW7JqNdHtHZrDo3y4oLBwCHv6IzTo/t5e7whWJrbt5Duf6

after_test:
  - OpenCover.4.6.519\tools\OpenCover.Console.exe -target:"NUnit.ConsoleRunner.3.8.0\tools\nunit3-console.exe" -targetargs:"--result nunit2 csharp-metar-decoder-tests\bin\Release\csharp-metar-decoder-tests.dll" -returntargetcode:10000 -log:All -register:Path32 -output:".\cover_results.xml"
  - coveralls.net.0.412\tools\csmacnz.Coveralls.exe --opencover -i .\cover_results.xml
  - more .\cover_results.xml
  
artifacts:
  - path: '**\csharp-metar-decoder.*.nupkg'
  
deploy:
  provider: NuGet
  api_key:
    secure: jbYoFWkojd44P+NkWZht17Vbdy6Hk2lrj8g0hfaEVUmH97z5MUK92XieuxY81U3B
  skip_symbols: true